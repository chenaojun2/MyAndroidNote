# 安卓系统启动流程

大体流程如图所示，由BootLoader引导开机 依次进入Linux Kernel，C++ Framework, Android Framework, 最后到App层启动App。

![alt 属性文本](../images/lancher/lancher01.png)

## Loader层

Loader层，在长按电源键时，主板通电。主板会引导芯片执行存储器烧录好的预设代码，加载程序到内存中。作用：内存检查，参数初始化。

## Kernel层

Loader层走完后就会进入 kernel层。该层主要会加载一些硬件驱动。在该层与上衣层中间会有一个硬件抽象层（HardWare Abstract Layer）。该层会给上层提供统一的硬件API。

## C++ FrameWork层

进入C++层，系统会开始创建第一个用户进程（init进程）。此外还会孵化出adbd 进程， logdd进程。init进程执行完还会孵化出第一个java进程（Zygote进程）。java进程会调用ZygoteInit这个类。

````
PS C代码调用Java代码流程
1、从classpath路径下搜索类，并返回类对象

2、获取类的默认构造方法ID

3、创建该类的实例

4、查找实例方法的id

5、调用对象的实例方法
````

## Android FrameWork层

ZygoteInit类会创建SystemServer系统服务进程。创建成功后，在SystemServer.java类的入口方法中会创建许许多多的Service（ActivityManagerService,WindowManagerService,PowerManagerService...） 

```
ZygoteInit类 main方法

1、预加载类、预加载资源、预加载动态库

2、启动system_server进程（核心进程）

3、创建Socket服务（该服务接受来自AMS的进程创建请求）

4、进入阻塞状态，处理来自AMS的申请进程创建请求

SystemServer类 main方法

1、创建系统服务的管理者

2、启动引导服务

3、启动核心服务

4、启动一般的服务(startOtherServices 的最后会调用lockSettings.systemReady(); 通知activityManager启动第三方应用)

```
![alt 属性文本](../images/lancher/lancher02.jpg)

## Apps 层

在创建完了一系列的就开始启动我们的Launcher App